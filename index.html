<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Suicide Statistics Visualization (2014-2023)</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/topojson@3"></script>
</head>
<body>
    <header>
        <h1>US Suicide Statistics Visualization</h1>
        <p class="subtitle">Data from 2014-2023 by State</p>
        <p class="subtitle" style="font-size: 0.85rem; margin-top: 0.5rem;">Interactive map and charts showing trends over time</p>
    </header>

    <div class="container">
        <aside class="controls-panel">
            <h2>Controls</h2>
            
            <div class="control-group">
                <label for="year-slider">Year: <span id="year-display">2014</span></label>
                <input type="range" id="year-slider" min="2014" max="2023" value="2014" step="1">
            </div>

            <div class="control-group">
                <label for="metric-toggle">Metric:</label>
                <div class="toggle-buttons" id="metric-toggle">
                    <button class="toggle-btn active" data-metric="deaths">Total Deaths</button>
                    <button class="toggle-btn" data-metric="rate">Age Adjusted Rate</button>
                </div>
                <div class="info-text" id="rate-info" style="display: none; margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-secondary); padding: 0.5rem; background: #f0f8ff; border-radius: 4px; border-left: 3px solid var(--accent-color);">
                    <strong>Age-Adjusted Rate:</strong> The rate per 100,000 population, adjusted for age differences between states. This allows fair comparison across states with different age distributions.
                </div>
            </div>

            <div class="control-group">
                <label>
                    <input type="checkbox" id="comparison-mode"> Comparison Mode
                </label>
            </div>

            <div class="control-group">
                <label for="state-filter">Filter States:</label>
                <div class="state-filter-controls">
                    <button id="select-all-states">Select All</button>
                    <button id="clear-all-states">Clear All</button>
                </div>
                <select id="state-filter" multiple size="10">
                    <!-- States will be populated by JavaScript -->
                </select>
            </div>
        </aside>

        <main class="visualization-area">
            <div class="viz-section">
                <h2>US Map</h2>
                <div id="map-container">
                    <div id="map-loading" class="loading">Loading map data...</div>
                    <svg id="map-svg"></svg>
                    <div id="map-legend"></div>
                </div>
            </div>

            <div class="charts-container">
                <div class="viz-section">
                    <h2>Trends Over Time</h2>
                    <div id="time-series-container">
                        <svg id="time-series-svg"></svg>
                    </div>
                </div>

                <div class="viz-section">
                    <h2>State Comparison</h2>
                    <div id="bar-chart-container">
                        <svg id="bar-chart-svg"></svg>
                    </div>
                </div>
            </div>

            <!-- Bar Chart Race - Automatic animation -->
            <div class="viz-section bar-race-section">
                <h2>Bar Chart Race</h2>
                <p style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 0.9rem;">
                    Watch how states rank over time from 2014 to 2023.
                </p>
                <div class="scroll-viz-controls">
                    <div class="toggle-buttons" id="race-metric-toggle">
                        <button class="toggle-btn active" data-metric="deaths">Total Deaths</button>
                        <button class="toggle-btn" data-metric="rate">Age Adjusted Rate</button>
                    </div>
                    <div class="race-controls" style="margin-left: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <button id="play-pause-btn" class="toggle-btn" style="min-width: 80px;">
                            <span id="play-pause-text">Pause</span>
                        </button>
                        <label style="font-size: 0.85rem; color: var(--text-secondary);">
                            Speed: 
                            <input type="range" id="speed-slider" min="200" max="2000" value="800" step="100" style="width: 100px; margin: 0 0.5rem;">
                            <span id="speed-display">800ms</span>
                        </label>
                    </div>
                </div>
                <div id="bar-race-container">
                    <div id="bar-race-chart">
                        <svg id="bar-race-svg"></svg>
                    </div>
                    <div id="race-year-indicator">
                        <div id="current-year-display">2014</div>
                        <div id="year-progress"></div>
                        <div id="total-value-display"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script src="script.js"></script>
</body>
</html>

