<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Suicide Statistics Visualization (2014-2023)</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/topojson@3"></script>
</head>
<body>
    <header>
        <h1>US Suicide Statistics Visualization</h1>
        <p class="subtitle">Data from 2014-2023 by State</p>
        <p class="subtitle" style="font-size: 0.85rem; margin-top: 0.5rem;">Interactive map and charts showing trends over time</p>
        
        <nav class="top-nav">
            <button id="open-race-combined-btn" class="nav-btn" data-tooltip="Bar Chart Race: Watch how states rank over time. Line Graph Race: Select states and watch animated line graphs showing trends from 2014 to 2023. Both visualizations are available on one page.">
                Race Visualizations
            </button>
            <button id="open-animated-map-btn" class="nav-btn" data-tooltip="Watch how state colors change over time from 2014 to 2023 with automatic year progression.">
                Animated Map
            </button>
            <button id="open-scroll-map-btn" class="nav-btn" data-tooltip="Scroll down the page to see the map change year by year from 2014 to 2023. The year updates automatically as you scroll.">
                Scroll Map
            </button>
        </nav>
    </header>

    <div class="container">
        <aside class="controls-panel">
            <h2>Controls</h2>
            
            <div class="control-group">
                <label for="year-slider">Year: <span id="year-display">2014</span></label>
                <input type="range" id="year-slider" min="2014" max="2023" value="2014" step="1">
            </div>

            <div class="control-group">
                <label for="metric-toggle">Metric:</label>
                <div class="toggle-buttons" id="metric-toggle">
                    <button class="toggle-btn" data-metric="deaths">Total Deaths</button>
                    <button class="toggle-btn active" data-metric="rate">Age Adjusted Rate</button>
                </div>
                <div class="info-text" id="rate-info" style="display: block !important; margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-secondary); padding: 0.75rem; background: #f0f8ff; border-radius: 4px; border-left: 3px solid var(--accent-color); line-height: 1.5;">
                    <strong>Age-Adjusted Rate Definition:</strong><br>
                    The age-adjusted rate is the number of deaths per 100,000 population, standardized to account for differences in age distribution between states. This statistical adjustment allows for fair comparisons across states with varying age demographics, as older populations typically have higher mortality rates. The rate is calculated using a standard population age distribution, ensuring that differences in rates reflect actual health outcomes rather than differences in population age structure.
                </div>
            </div>

            <div class="control-group">
                <label>
                    <input type="checkbox" id="comparison-mode"> Comparison Mode
                </label>
            </div>

            <div class="control-group">
                <label for="state-filter">Filter States:</label>
                <div class="state-filter-controls">
                    <button id="select-all-states">Select All</button>
                    <button id="clear-all-states">Clear All</button>
                </div>
                <select id="state-filter" multiple size="10">
                    <!-- States will be populated by JavaScript -->
                </select>
            </div>
        </aside>

        <main class="visualization-area">
            <div class="viz-section">
                <h2>US Map</h2>
                <div id="map-container">
                    <div id="map-loading" class="loading">Loading map data...</div>
                    <svg id="map-svg"></svg>
                    <div id="map-legend"></div>
                </div>
            </div>

            <div class="charts-container">
                <div class="viz-section">
                    <h2>Trends Over Time</h2>
                    <div id="time-series-container">
                        <svg id="time-series-svg"></svg>
                    </div>
                </div>

                <div class="viz-section">
                    <h2>State Comparison</h2>
                    <div id="bar-chart-container">
                        <svg id="bar-chart-svg"></svg>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script src="script.js"></script>
</body>
</html>

